# REF: https://github.com/robcowart/docker_compose_cookbook/blob/master/nifi/docker-compose.yml
version: '3'

services:
  nifi:
    build: 
      context: .
      args: 
        NIFI_VERSION: ${NIFI_VERSION}
    container_name: nifi
    user: root
    restart: unless-stopped
    ports:
      # - ${NIFI_HTTP_PORT}:8080/tcp 
      - ${NIFI_HTTPS_PORT}:8443/tcp
      - 10000
    volumes:
      - ./drivers:/opt/nifi/nifi-current/drivers
      - ./templates:/opt/nifi/nifi-current/templates
      - ./data:/opt/nifi/nifi-current/data
    environment:
      TZ: 'Asia/Seoul' # Timezone

      NIFI_JVM_HEAP_INIT: ${NIFI_HEAP_INIT} #   The initial JVM heap size.
      NIFI_JVM_HEAP_MAX: ${NIFI_HEAP_MAX} #   The maximum JVM heap size.

      # NIFI_HTTP_PORT: ${NIFI_HTTP_PORT}
      # NIFI_HTTP_HOST: ${NIFI_HTTP_HOST}
      NIFI_HTTPS_PORT: ${NIFI_HTTPS_PORT}
      NIFI_HTTPS_HOST: ${NIFI_HTTP_HOST}
      # NIFI_WEB_PROXY_CONTEXT_PATH: /traefik/,/gateway/nifi/nifi-app/

      SINGLE_USER_CREDENTIALS_USERNAME: admin
      SINGLE_USER_CREDENTIALS_PASSWORD: admin12345678
      
#   nifi-registry:
#     image: apache/nifi-registry:latest
#     ports:
#       - 18080:18080
#     network_mode: bridge